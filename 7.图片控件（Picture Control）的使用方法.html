<html>
<head>
  <title>7.图片控件（Picture Control）的使用方法</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307027 (zh-CN, DDL); Windows/6.1.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="334"/>
<h1>7.图片控件（Picture Control）的使用方法</h1>

<div>
<span><div><font style="font-size: 14pt;"><span style="font-family: 楷体; font-size: 14pt; font-weight: bold;">1.Picture Control显示图片</span></font></div><div><span style="min-height: 11pt; color: rgb(0, 0, 255); font-family: Consolas;"><font style="font-size: 14pt;"><span style="color: rgb(0, 0, 255); font-family: Consolas;">   </span> <span style="color: rgb(0, 0, 255); font-family: Consolas;">例子：</span><span style="min-height: 11pt; color: rgb(0, 0, 255); font-family: Consolas;">在Picture Control控件上，</span><span style="color: rgb(0, 0, 255); font-family: Consolas;">显示logo.bmp文件</span></font></span></div><div><font style="font-size: 14pt;"><span style="min-height: 11pt; color: rgb(0, 0, 255); font-family: Consolas;">    CImage</span> <span style="min-height: 11pt; color: rgb(0, 0, 128); font-family: Consolas;">logoImage</span><span style="min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">;</span></font></div><div style="min-height: 11pt;"><font style="font-size: 14pt;"><span style="min-height: 11pt; color: rgb(0, 0, 128); font-family: Consolas;">    logoImage</span><span style="min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">.</span><span style="min-height: 11pt; color: rgb(136, 0, 0); font-family: Consolas;">Load</span><span style="min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">(</span><span style="min-height: 11pt; color: rgb(160, 0, 160); font-family: Consolas;">_T</span><span style="min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">(</span><span style="min-height: 11pt; color: rgb(163, 21, 21); font-family: Consolas;">&quot;res\\logo.bmp&quot;</span><span style="min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">));</span></font></div><div style="min-height: 11pt;"><font style="font-size: 14pt;"><span style="min-height: 11pt; color: rgb(0, 0, 255); font-family: Consolas;">    CRect</span> <span style="min-height: 11pt; color: rgb(0, 0, 128); font-family: Consolas;">rect</span><span style="min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">;</span></font></div><div style="min-height: 11pt;"><font style="font-size: 14pt;"><span style="min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">    </span><span style="min-height: 11pt; color: rgb(0, 0, 255); font-family: Consolas;">CWnd</span> <span style="min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">*</span><span style="min-height: 11pt; color: rgb(0, 0, 128); font-family: Consolas;">pWnd</span> <span style="min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">=</span> <span style="min-height: 11pt; color: rgb(136, 0, 0); font-family: Consolas;">GetDlgItem</span><span style="min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">(</span><span style="min-height: 11pt; color: rgb(160, 0, 160); font-family: Consolas;">IDC_TCT_LOGO</span><span style="min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">);</span></font></div><div style="min-height: 11pt;"><font style="font-size: 14pt;"><span style="min-height: 11pt; color: rgb(0, 0, 128); font-family: Consolas;">    pWnd</span><span style="min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">-&gt;</span><span style="min-height: 11pt; color: rgb(136, 0, 0); font-family: Consolas;">GetClientRect</span><span style="min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">(&amp;</span><span style="min-height: 11pt; color: rgb(0, 0, 128); font-family: Consolas;">rect</span><span style="min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">);</span></font></div><div style="min-height: 11pt;"><font style="font-size: 14pt;"><span style="min-height: 11pt; color: rgb(0, 0, 255); font-family: Consolas;">    CDC</span> <span style="min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">*</span><span style="min-height: 11pt; color: rgb(0, 0, 128); font-family: Consolas;">pDC</span> <span style="min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">=</span> <span style="min-height: 11pt; color: rgb(0, 0, 128); font-family: Consolas;">pWnd</span><span style="min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">-&gt;</span><span style="min-height: 11pt; color: rgb(136, 0, 0); font-family: Consolas;">GetDC</span><span style="min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">();</span></font></div><div style="min-height: 11pt;"><font style="font-size: 14pt;"><span style="min-height: 11pt; color: rgb(0, 0, 128); font-family: Consolas;">    pDC</span><span style="min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">-&gt;</span><span style="min-height: 11pt; color: rgb(136, 0, 0); font-family: Consolas;">SetStretchBltMode</span><span style="min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">(</span><span style="min-height: 11pt; color: rgb(160, 0, 160); font-family: Consolas;">STRETCH_HALFTONE</span><span style="min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">);</span></font></div><div style="min-height: 11pt;"><font style="font-size: 14pt;"><span style="min-height: 11pt; color: rgb(0, 0, 128); font-family: Consolas;">    logoImage</span><span style="min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">.</span><span style="min-height: 11pt; color: rgb(136, 0, 0); font-family: Consolas;">Draw</span><span style="min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">(</span><span style="min-height: 11pt; color: rgb(0, 0, 128); font-family: Consolas;">pDC</span><span style="min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">-&gt;</span><span style="min-height: 11pt; color: rgb(0, 0, 128); font-family: Consolas;">m_hDC</span><span style="min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">,</span> <span style="min-height: 11pt; color: rgb(0, 0, 128); font-family: Consolas;">rect</span><span style="min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">);</span></font></div><div style="min-height: 11pt;"><font style="font-size: 14pt;"><span style="min-height: 11pt; color: rgb(136, 0, 0); font-family: Consolas;">    ReleaseDC</span><span style="min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">(</span><span style="min-height: 11pt; color: rgb(0, 0, 128); font-family: Consolas;">pDC</span><span style="min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">);</span></font></div><div><font style="font-size: 14pt;"><span style="min-height: 11pt; color: rgb(0, 0, 128); font-family: Consolas;">    logoImage</span><span style="min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">.</span><span style="min-height: 11pt; color: rgb(136, 0, 0); font-family: Consolas;">Destroy</span><span style="min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">();</span></font></div><div><font style="font-size: 14pt;"><span style="min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;"><br/></span></font></div><div><font style="font-size: 14pt;"><span style="font-family: 楷体; font-size: 14pt; font-weight: bold;">2.Picture Control控件做为状态灯</span></font></div><div><span style="min-height: 11pt;"><span style="color: rgb(0, 128, 0); font-family: Consolas; font-weight: bold; font-size: 14pt;">    /*定义颜色*/</span></span></div><div style="min-height: 11pt;"><span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 255); font-family: Consolas;">    #define</span> <span style="min-height: 11pt; font-size: 14pt; color: rgb(160, 0, 160); font-family: Consolas;">BLACK</span> <span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">0x000000</span></div><div style="min-height: 11pt;"><span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 255); font-family: Consolas;">    #define</span> <span style="min-height: 11pt; font-size: 14pt; color: rgb(160, 0, 160); font-family: Consolas;">RED</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">   0x000ff0    </span></div><div style="min-height: 11pt;"><span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 255); font-family: Consolas;">    #define</span> <span style="min-height: 11pt; font-size: 14pt; color: rgb(160, 0, 160); font-family: Consolas;">BLUE</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">  0xff0000</span></div><div><span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 255); font-family: Consolas;">    #define</span> <span style="min-height: 11pt; font-size: 14pt; color: rgb(160, 0, 160); font-family: Consolas;">GREEN</span> <span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">0x00ff00</span></div><div><br/></div><div><span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 255); font-family: Consolas;">    void</span> <span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 255); font-family: Consolas;">CSimATODlg</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">::</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(136, 0, 0); font-family: Consolas;">DrawA</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">(</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 255); font-family: Consolas;">int</span> <span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 128); font-family: Consolas;">nID</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">,</span> <span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 255); font-family: Consolas;">long</span> <span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 128); font-family: Consolas;">ys</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">)</span></div><div style="min-height: 11pt;"><span style="min-height: 11pt;"><span style="color: rgb(1, 1, 1); font-family: Consolas; font-size: 14pt;">    {</span></span></div><div style="min-height: 11pt;"><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">       </span><span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 255); font-family: Consolas;">CRect</span> <span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 128); font-family: Consolas;">conRect</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">;</span></div><div style="min-height: 11pt;"><span style="font-size: 14pt; min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">       </span><span style="font-size: 14pt; min-height: 11pt; color: rgb(0, 0, 255); font-family: Consolas;">CWnd</span> <span style="font-size: 14pt; min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">*</span><span style="font-size: 14pt; min-height: 11pt; color: rgb(0, 0, 128); font-family: Consolas;">pWnd</span><span style="font-size: 14pt; min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">=</span><span style="font-size: 14pt; min-height: 11pt; color: rgb(136, 0, 0); font-family: Consolas;">GetDlgItem</span><span style="font-size: 14pt; min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">(</span><span style="font-size: 14pt; min-height: 11pt; color: rgb(0, 0, 128); font-family: Consolas;">nID</span><span style="font-size: 14pt; min-height: 11pt; color: rgb(1, 1, 1); font-family: Consolas;">);</span><span style="min-height: 11pt;"><span style="color: rgb(0, 128, 0); font-family: Consolas; font-size: 14pt;">//</span><span style="min-height: 11pt;"><span style="color: rgb(0, 128, 0); font-family: 楷体; font-size: 14pt;">指定的图像控件中绘制</span></span></span></div><div style="min-height: 11pt;"><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">       </span><span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 255); font-family: Consolas;">CDC</span> <span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">*</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 128); font-family: Consolas;">pDC</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">=</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 128); font-family: Consolas;">pWnd</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">-&gt;</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(136, 0, 0); font-family: Consolas;">GetDC</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">();</span></div><div style="min-height: 11pt;"><font style="font-size: 14pt;"><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">       ::</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(136, 0, 0); font-family: Consolas;">GetClientRect</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">(</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 128); font-family: Consolas;">pWnd</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">-&gt;</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 128); font-family: Consolas;">m_hWnd</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">,</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 128); font-family: Consolas;">conRect</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">);</span></font></div><div style="min-height: 11pt;"><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">       </span><span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 255); font-family: Consolas;">CBrush</span> <span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 128); font-family: Consolas;">NewBrush</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">((</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 255); font-family: Consolas;">COLORREF</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">)</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 128); font-family: Consolas;">ys</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">);</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 128, 0); font-family: Consolas;">//设置指示灯指示灯颜色</span></div><div style="min-height: 11pt;"><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">       </span><span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 255); font-family: Consolas;">CBrush</span> <span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">*</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 128); font-family: Consolas;">pOldBrush</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">=</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 128); font-family: Consolas;">pDC</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">-&gt;</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(136, 0, 0); font-family: Consolas;">SelectObject</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">(&amp;</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 128); font-family: Consolas;">NewBrush</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">); </span></div><div style="min-height: 11pt;"><font style="font-size: 14pt;"><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">       </span><span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 128); font-family: Consolas;">pDC</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">-&gt;</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(136, 0, 0); font-family: Consolas;">SetViewportOrg</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">(</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 128); font-family: Consolas;">conRect</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">.</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 128); font-family: Consolas;">right</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">/2,</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 128); font-family: Consolas;">conRect</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">.</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 128); font-family: Consolas;">bottom</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">/2);</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 128, 0); font-family: Consolas;">//在图像控件的中D间绘制</span></font></div><div style="min-height: 11pt;"><font style="font-size: 14pt;"><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">       </span><span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 128); font-family: Consolas;">pDC</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">-&gt;</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(136, 0, 0); font-family: Consolas;">Ellipse</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">(-15,-15,15,15);</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 128, 0); font-family: Consolas;">//按指定大小画-圆2</span></font></div><div style="min-height: 11pt;"><font style="font-size: 14pt;"><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">       </span><span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 128); font-family: Consolas;">pDC</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">-&gt;</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(136, 0, 0); font-family: Consolas;">SelectObject</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">(</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 128); font-family: Consolas;">pOldBrush</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">);</span></font></div><div style="min-height: 11pt;"><font style="font-size: 14pt;"><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">       </span><span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 128); font-family: Consolas;">pWnd</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">-&gt;</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(136, 0, 0); font-family: Consolas;">ReleaseDC</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">(</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(0, 0, 128); font-family: Consolas;">pDC</span><span style="min-height: 11pt; font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">);</span></font></div><div><span style="min-height: 11pt;"><span style="color: rgb(1, 1, 1); font-family: Consolas; font-size: 14pt;">    }</span></span></div></span>
</div></body></html> 